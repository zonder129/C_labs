9. Разработать средствами MPI параллельную программу моделирования распространения электрических сигналов в двухмерной прямоугольной сетке RC-элементов (одномерный аналог которых представлен на рис. выше). Метод формирования математической модели - узловой. Метод численного интегрирования - явный Эйлера. Внешнее воздействие - источники тока и напряжения. Количество элементов в сетке, временной интервал моделирования и количество параллельных процессов - параметры программы. Программа должна демонстрировать ускорение по сравнению с последовательным вариантом. Предусмотреть визуализацию результатов посредством утилиты gnuplot. 

Узловой метод для формирования математической модели электрической системы использует уравнение второго закона Кирхгофа - сумма токов в узле равна нулю. Это уравнение для любого i-ого узла в цепочке (кроме крайних) имеет вид
IRл - IRп - IC =0, где

IRл=(Ui-1-Ui)/R - электрический ток через "левое" сопротивление;

IRп=(Ui-Ui+1)/R - электрический ток через "правое" сопротивление;

IC=C*dUi/dt - электрический ток через ёмкость;

Ui - электрический потенциал узла с номером i.

Явный метод Эйлера для численного интегрирования ОДУ подразумевает аппроксимацию производных по времени "разностями вперёд", поэтому дискретизированное уравнение баланса токов в узле принимает следующий вид:

(Uni-1-Uni)/R -  (Uni-Uni+1)/R -  C*(Un+1i-Uni)/ht, где

ht - величина шага численного интегрирования.

Из него легко выразить единственную неизвестную величину

Un+1i=(Uni-1-2*Uni +Uni+1)*ht/(R*C)-Uni

Что, в свою очередь, дает возможность просто организовать вычислительный процесс в виде "цикл в цикле" (без деталей, связанных с крайними узлами):

for (n=0; n<N; n++)
  for (i=0; i<M; i++)
    Un+1i = ...
Напомним, что значения U0i известны из начальных условий. Здесь N=Tкон/ht 